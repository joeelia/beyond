<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom WebSocket Handlers | Laravel WebSockets 🛰</title>
    <meta name="description" content="WebSockets for Laravel. Done right.">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/laravel-websockets/assets/css/0.styles.d23a6950.css" as="style"><link rel="preload" href="/laravel-websockets/assets/js/app.be755737.js" as="script"><link rel="preload" href="/laravel-websockets/assets/js/5.b53140c4.js" as="script"><link rel="prefetch" href="/laravel-websockets/assets/js/10.6e877d46.js"><link rel="prefetch" href="/laravel-websockets/assets/js/11.d328b102.js"><link rel="prefetch" href="/laravel-websockets/assets/js/12.58c66a3b.js"><link rel="prefetch" href="/laravel-websockets/assets/js/13.944ef160.js"><link rel="prefetch" href="/laravel-websockets/assets/js/14.3370b42f.js"><link rel="prefetch" href="/laravel-websockets/assets/js/15.a67e5211.js"><link rel="prefetch" href="/laravel-websockets/assets/js/16.376b6117.js"><link rel="prefetch" href="/laravel-websockets/assets/js/17.3da46033.js"><link rel="prefetch" href="/laravel-websockets/assets/js/2.0757df4b.js"><link rel="prefetch" href="/laravel-websockets/assets/js/3.8f17d77f.js"><link rel="prefetch" href="/laravel-websockets/assets/js/4.036088d7.js"><link rel="prefetch" href="/laravel-websockets/assets/js/6.18dd344c.js"><link rel="prefetch" href="/laravel-websockets/assets/js/7.962ed742.js"><link rel="prefetch" href="/laravel-websockets/assets/js/8.34981749.js"><link rel="prefetch" href="/laravel-websockets/assets/js/9.2c249195.js">
    <link rel="stylesheet" href="/laravel-websockets/assets/css/0.styles.d23a6950.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/laravel-websockets/" class="home-link router-link-active"><!----> <span class="site-name">Laravel WebSockets 🛰</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/beyondcode/laravel-websockets" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="websocket-link can-hide"><a>0 users reading the documentation</a> <a><div class="notification"></div></a></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/beyondcode/laravel-websockets" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/laravel-websockets/1.0/getting-started/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/laravel-websockets/1.0/getting-started/installation.html" class="sidebar-link">Installation</a></li><li><a href="/laravel-websockets/1.0/getting-started/questions-issues.html" class="sidebar-link">Questions and issues</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Basic Usage</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/laravel-websockets/1.0/basic-usage/pusher.html" class="sidebar-link">Pusher Replacement</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/pusher.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/pusher.html#pusher-configuration" class="sidebar-link">Pusher Configuration</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/pusher.html#configuring-websocket-apps" class="sidebar-link">Configuring WebSocket Apps</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/pusher.html#usage-with-laravel-echo" class="sidebar-link">Usage with Laravel Echo</a></li></ul></li><li><a href="/laravel-websockets/1.0/basic-usage/starting.html" class="sidebar-link">Starting the WebSocket server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/starting.html#using-a-different-port" class="sidebar-link">Using a different port</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/starting.html#restricting-the-listening-host" class="sidebar-link">Restricting the listening host</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/starting.html#keeping-the-socket-server-running-with-supervisord" class="sidebar-link">Keeping the socket server running with supervisord</a></li></ul></li><li><a href="/laravel-websockets/1.0/basic-usage/ssl.html" class="sidebar-link">SSL Support</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/ssl.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/ssl.html#client-configuration" class="sidebar-link">Client configuration</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/ssl.html#server-configuration" class="sidebar-link">Server configuration</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/ssl.html#usage-with-laravel-valet" class="sidebar-link">Usage with Laravel Valet</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/basic-usage/ssl.html#usage-with-a-reverse-proxy-like-nginx" class="sidebar-link">Usage with a reverse proxy (like Nginx)</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Debugging</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/laravel-websockets/1.0/debugging/console.html" class="sidebar-link">Console Logging</a></li><li><a href="/laravel-websockets/1.0/debugging/dashboard.html" class="sidebar-link">Debug Dashboard</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/debugging/dashboard.html#accessing-the-dashboard" class="sidebar-link">Accessing the Dashboard</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/debugging/dashboard.html#protecting-the-dashboard" class="sidebar-link">Protecting the Dashboard</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/debugging/dashboard.html#statistics" class="sidebar-link">Statistics</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/debugging/dashboard.html#cleanup-old-statistics" class="sidebar-link">Cleanup old Statistics</a></li><li class="sidebar-sub-header"><a href="/laravel-websockets/1.0/debugging/dashboard.html#event-creator" class="sidebar-link">Event Creator</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Advanced usage</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/laravel-websockets/1.0/advanced-usage/app-providers.html" class="sidebar-link">Custom App Providers</a></li><li><a href="/laravel-websockets/1.0/advanced-usage/custom-websocket-handlers.html" class="active sidebar-link">Custom WebSocket Handlers</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>FAQ</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/laravel-websockets/1.0/faq/deploying.html" class="sidebar-link">Deploying</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/laravel-websockets/1.0/faq/scaling.html" class="sidebar-link">... but does it scale?</a></li></ul></div></li></ul>  <div class="sidebar-heading sidebar-footer">
      Built by <a href="https://beyondco.de" target="_blank">Beyond Code</a> and <a href="https://spatie.be">Spatie</a>.
    </div></div> <div class="page"> <div class="content"><h1 id="custom-websocket-handlers"><a href="#custom-websocket-handlers" aria-hidden="true" class="header-anchor">#</a> Custom WebSocket Handlers</h1> <p>While this package's main purpose is to make the usage of either the Pusher JavaScript client or Laravel Echo as easy as possible, you are not limited to the Pusher protocol at all.
There might be situations where all you need is a simple, bare-bone, WebSocket server where you want to have full control over the incoming payload and what you want to do with it - without having &quot;channels&quot; in the way.</p> <p>You can easily create your own custom WebSocketHandler class. All you need to do is implement Ratchets <code>Ratchet\WebSocket\MessageComponentInterface</code>.</p> <p>Once implemented, you will have a class that looks something like this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Ratchet<span class="token punctuation">\</span>ConnectionInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Ratchet<span class="token punctuation">\</span>RFC6455<span class="token punctuation">\</span>Messaging<span class="token punctuation">\</span>MessageInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Ratchet<span class="token punctuation">\</span>WebSocket<span class="token punctuation">\</span>MessageComponentInterface</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyCustomWebSocketHandler</span> <span class="token keyword">implements</span> <span class="token class-name">MessageComponentInterface</span>
<span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onOpen</span><span class="token punctuation">(</span>ConnectionInterface <span class="token variable">$connection</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// TODO: Implement onOpen() method.</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onClose</span><span class="token punctuation">(</span>ConnectionInterface <span class="token variable">$connection</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// TODO: Implement onClose() method.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onError</span><span class="token punctuation">(</span>ConnectionInterface <span class="token variable">$connection</span><span class="token punctuation">,</span> \<span class="token package">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// TODO: Implement onError() method.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onMessage</span><span class="token punctuation">(</span>ConnectionInterface <span class="token variable">$connection</span><span class="token punctuation">,</span> MessageInterface <span class="token variable">$msg</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// TODO: Implement onMessage() method.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the class itself you have full control over all the lifecycle events of your WebSocket connections and can intercept the incoming messages and react to them.</p> <p>The only part missing is, that you will need to tell our WebSocket server to load this handler at a specific route endpoint. This can be achieved using the <code>WebSocketsRouter</code> facade.</p> <p>This class takes care of registering the routes with the actual webSocket server. You can use the <code>webSocket</code> method to define a custom WebSocket endpoint. The method needs two arguments: the path where the WebSocket handled should be available and the fully qualified classname of the WebSocket handler class.</p> <p>This could, for example, be done inside your <code>routes/web.php</code> file.</p> <div class="language-php extra-class"><pre class="language-php"><code>WebSocketsRouter<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">webSocket</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/my-websocket'</span><span class="token punctuation">,</span> \<span class="token package">App<span class="token punctuation">\</span>MyCustomWebSocketHandler</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Once you've added the custom WebSocket route, be sure to restart our WebSocket server for the changes to take place.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/beyondcode/docs.beyondco.de/edit/master/resources/docs/laravel-websockets/1.0/advanced-usage/custom-websocket-handlers.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/laravel-websockets/1.0/advanced-usage/app-providers.html" class="prev">
          Custom App Providers
        </a></span> <span class="next"><a href="/laravel-websockets/1.0/faq/deploying.html">
          Deploying
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/laravel-websockets/assets/js/5.b53140c4.js" defer></script><script src="/laravel-websockets/assets/js/app.be755737.js" defer></script>
  </body>
</html>
